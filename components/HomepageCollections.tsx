import React from "react";
import React from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  Dimensions,\n} from 'react-native';\nimport { ChevronRight } from 'lucide-react-native';\nimport { trpc } from '@/lib/trpc';\nimport { HomepageCollection } from '@/types/collection';\nimport { OptimizedImage } from './OptimizedImage';\nimport { SkeletonLoader } from './SkeletonLoader';\n\nconst { width } = Dimensions.get('window');\nconst COLLECTION_WIDTH = width - 32;\nconst COLLECTION_HEIGHT = 200;\n\ninterface CollectionCardProps {\n  collection: HomepageCollection;\n  onPress: (collection: HomepageCollection) => void;\n}\n\nconst CollectionCard: React.FC<CollectionCardProps> = ({ collection, onPress }) => {\n  return (\n    <TouchableOpacity\n      style={styles.collectionCard}\n      onPress={() => onPress(collection)}\n      activeOpacity={0.8}\n    >\n      <View style={styles.imageContainer}>\n        <OptimizedImage\n          source={{ uri: collection.cover_image_url || 'https://images.unsplash.com/photo-1489599162163-3fb4b4b5b0b3?w=800&h=400&fit=crop' }}\n          style={styles.collectionImage}\n          resizeMode=\"cover\"\n        />\n        <View style={styles.overlay} />\n        <View style={styles.collectionContent}>\n          <View style={styles.collectionHeader}>\n            <Text style={styles.collectionTitle} numberOfLines={2}>\n              {collection.title}\n            </Text>\n            <ChevronRight size={20} color=\"#fff\" />\n          </View>\n          {collection.description && (\n            <Text style={styles.collectionDescription} numberOfLines={2}>\n              {collection.description}\n            </Text>\n          )}\n          <Text style={styles.dramaCount}>\n            {collection.drama_count} {collection.drama_count === 1 ? 'drama' : 'dramas'}\n          </Text>\n        </View>\n      </View>\n    </TouchableOpacity>\n  );\n};\n\ninterface HomepageCollectionsProps {\n  onCollectionPress: (collection: HomepageCollection) => void;\n}\n\nexport const HomepageCollections: React.FC<HomepageCollectionsProps> = ({\n  onCollectionPress,\n}) => {\n  const collectionsQuery = trpc.collections.getHomepage.useQuery();\n\n  if (collectionsQuery.isLoading) {\n    return (\n      <View style={styles.container}>\n        <Text style={styles.sectionTitle}>Featured Collections</Text>\n        <ScrollView\n          horizontal\n          showsHorizontalScrollIndicator={false}\n          contentContainerStyle={styles.scrollContent}\n        >\n          {[1, 2, 3].map((index) => (\n            <View key={index} style={styles.collectionCard}>\n              <SkeletonLoader width={COLLECTION_WIDTH} height={COLLECTION_HEIGHT} />\n            </View>\n          ))}\n        </ScrollView>\n      </View>\n    );\n  }\n\n  if (collectionsQuery.error || !collectionsQuery.data?.length) {\n    return null;\n  }\n\n  const collections = collectionsQuery.data;\n\n  return (\n    <View style={styles.container}>\n      <Text style={styles.sectionTitle}>Featured Collections</Text>\n      <ScrollView\n        horizontal\n        showsHorizontalScrollIndicator={false}\n        contentContainerStyle={styles.scrollContent}\n        decelerationRate=\"fast\"\n        snapToInterval={COLLECTION_WIDTH + 16}\n        snapToAlignment=\"start\"\n      >\n        {collections.map((collection) => (\n          <CollectionCard\n            key={collection.id}\n            collection={collection}\n            onPress={onCollectionPress}\n          />\n        ))}\n      </ScrollView>\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    marginVertical: 20,\n  },\n  sectionTitle: {\n    fontSize: 22,\n    fontWeight: 'bold' as const,\n    color: '#1a1a1a',\n    marginBottom: 16,\n    marginHorizontal: 16,\n  },\n  scrollContent: {\n    paddingHorizontal: 16,\n  },\n  collectionCard: {\n    width: COLLECTION_WIDTH,\n    height: COLLECTION_HEIGHT,\n    marginRight: 16,\n    borderRadius: 16,\n    overflow: 'hidden',\n    elevation: 4,\n    shadowColor: '#000',\n    shadowOffset: {\n      width: 0,\n      height: 2,\n    },\n    shadowOpacity: 0.25,\n    shadowRadius: 3.84,\n  },\n  imageContainer: {\n    flex: 1,\n    position: 'relative',\n  },\n  collectionImage: {\n    width: '100%',\n    height: '100%',\n  },\n  overlay: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    backgroundColor: 'rgba(0, 0, 0, 0.4)',\n  },\n  collectionContent: {\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    padding: 20,\n  },\n  collectionHeader: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    justifyContent: 'space-between',\n    marginBottom: 8,\n  },\n  collectionTitle: {\n    fontSize: 20,\n    fontWeight: 'bold' as const,\n    color: '#fff',\n    flex: 1,\n    marginRight: 12,\n  },\n  collectionDescription: {\n    fontSize: 14,\n    color: '#e0e0e0',\n    marginBottom: 8,\n    lineHeight: 20,\n  },\n  dramaCount: {\n    fontSize: 12,\n    color: '#b0b0b0',\n    fontWeight: '500' as const,\n  },\n});